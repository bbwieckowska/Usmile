% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3_function_CLBplot.R
\name{CLBplot}
\alias{CLBplot}
\title{Calibration Plot with Brier Score Comparison}
\usage{
CLBplot(data_ref, data_new, title = "Calibration Plot", n_bins = 10)
}
\arguments{
\item{data_ref}{List containing reference model output from \code{USprep_mdl} with elements:
\itemize{
\item y - vector of observed values (0/1)
\item p - vector of predicted probabilities
\item n_vars - number of predictor variables in the model
}}

\item{data_new}{List containing new model output from \code{USprep_mdl} (same structure as data_ref)}

\item{title}{Plot title (default: "Calibration Plot")}

\item{n_bins}{Number of bins for calibration calculation (default: 10)}
}
\value{
A list containing:
\itemize{
\item plot - ggplot object showing calibration curves for both models
\item results_table - data frame with Brier score metrics:
\itemize{
\item Brier_ref - Brier score for reference model
\item Brier_new - Brier score for new model
\item Delta_Brier - Improvement in Brier score (reference - new)
\item BSS - Brier Skill Score (relative improvement)
}
}
}
\description{
Creates a calibration plot comparing predicted vs. empirical probabilities for two models,
along with a table of Brier score metrics. The plot shows how well predicted probabilities
match observed event rates across probability bins.
}
\examples{
\dontrun{
# Load Heart Disease datasets
data(heart_disease)
data(heart_disease_train)
data(heart_disease_test)

# Prepare model outputs
model_glm_ref <- glm(disease ~ age + sex + bp + chol, data = train_data, family = "binomial")
model_glm_new <- glm(disease ~ age + sex + bp + chol + cp, data = train_data, family = "binomial")

train_out_ref <- USprep_mdl(model_glm_ref, dataset = NULL, testing = FALSE)
train_out_new <- USprep_mdl(model_glm_new, dataset = NULL, testing = FALSE)

# Create calibration plot for training data
calibration_results <- CLBplot(
  data_ref = train_out_ref,
  data_new = train_out_new,
  title = "Calibration: Basic vs Extended Cardiac Risk Model"
)

# Display plot and metrics
calibration_results$plot
calibration_results$results_table

# Example with test data and custom bins
test_out_ref <- USprep_mdl(model_glm_ref, dataset = test_data, testing = TRUE)
test_out_new <- USprep_mdl(model_glm_new, dataset = test_data, testing = TRUE)

CLBplot(
  data_ref = test_out_ref,
  data_new = test_out_new,
  n_bins = 5,
  title = "Test Data Calibration (5 bins)"
)
}

}
